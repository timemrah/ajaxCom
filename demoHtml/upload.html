<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ajaxCom Upload Demo</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Not required for ajaxCom -->
    <style type="text/css" rel="stylesheet">
        body       { font-family: sans-serif; font-size: 1rem; margin: 0; }
        form       { width: 50%; max-width: 400px; min-width: 300px; margin: auto; margin-top: 5rem; }
        form > div { margin-bottom: 1rem; }
        label      { display: inline-block; margin-bottom: 0.3rem; font-weight: bold; }
        input      { width: 100%; padding: 10px; }
        button     { padding: 10px 20px; }
        small      { color: red; }
        #ajaxCom-alert{ font-size: 1.5rem; margin-bottom: 1rem; text-align: center; }
        #progressBar{ display: inline-block; height: 10px; width: 0%; background-color: blue; transition-duration: 0.1s; }
    </style>
    <!-- //Not required for ajaxCom -->

    <style type="text/css" rel="stylesheet">
        .is-invalid{ color: red; border-color: red; }
    </style>

</head>
<body>




<form id="ajaxCom-test-form" action="../demoAjaxResponse/upload-response.php" method="post">

    <div id="ajaxCom-alert"></div>

    <div>
        <label>Select Image</label><br />
        <input id="imageInput" name="image" type="file" accept="image/*" multiple>
        <small id="imageHelper"></small>
    </div>
    <div>
        <button>Upload</button>
    </div>

    <div id="progressBar"></div>


</form>




<script src="../dist/ajaxCom.js"></script>
<script>

    //DOM access
    let $form = document.getElementById('ajaxCom-test-form');
    let $progressBar = document.getElementById('progressBar');
    let $image = document.getElementById('imageInput');

    //Form submit event handler
    $form.addEventListener('submit', e => { e.preventDefault();

        //If the send button was pressed without selecting an image.
        if($image.files.length < 1){
            alert('Please select the image');
            $image.click();
            return false;
        }

        //We instantiate the FormData class and retrieve file data.
        let formData   = new FormData($form);

        //Ajax start on ajaxCom
        ajaxCom($form.action, $form.method, new FormData($form), $progressBar).then(json => {

            console.log(json); //Look at the console for available json data

            if(json.status !== true){
                //Do something for the fail..
                return false;
            }

            //Do something for the success..

        }).catch(e => {

            //Do something for the ajaxCom Json Fatal Error..
            console.log(e);

        }).finally(() => {

            //Do something for always..

        });
        //Ajax start on ajaxCom//

    });
    //Form submit event handler//


</script>
</body>
</html>